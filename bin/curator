#!/usr/bin/env php
<?php

$dir = [
    'cwd' => getcwd(),
    'app' => dirname(__DIR__),
];

if (file_exists("{$dir['cwd']}/vendor/autoload.php")) {
    require_once "{$dir['cwd']}/vendor/autoload.php";
} else {
    require_once __DIR__.'/../../../autoload.php';
}

$definitions = [];

foreach ($dir as $directory) {
    if (file_exists("{$directory}/config/curator.php")) {
        $definitions = array_replace_recursive($definitions, include "{$directory}/config/curator.php");
    }
}

$definitions = array_replace_recursive($definitions, include "{$dir['app']}/config/services.php");

// creating lightweight DI container
$container = \Curator\Application\ContainerBuilder::build($definitions);
$container->get('Application')->run();
